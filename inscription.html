<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription ProFinder - Devenez un Expert</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="style.css"> 
    
    <style>
        /* Styles sp√©cifiques pour le design ProFinder (Noir/Or) */
        :root {
            --step-active: var(--accent-color);
            --step-inactive: #444;
            --step-complete: #28a745;
        }

        .form-card {
            background-color: var(--input-bg); 
            border: 1px solid #333;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            min-height: 450px; /* Hauteur minimale pour √©viter le saut lors du changement d'√©tape */
        }

        .form-control, .form-select {
            background-color: var(--chat-bg) !important; 
            color: var(--text-light) !important; 
            border: 1px solid #444 !important;
        }
        
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        .step {
            flex-grow: 1;
            text-align: center;
            padding: 10px 0;
            margin: 0 5px;
            border-bottom: 4px solid var(--step-inactive);
            color: var(--secondary-text);
            transition: all 0.3s;
            font-weight: 600;
        }
        .step.active {
            border-color: var(--step-active);
            color: var(--text-light);
        }
        .step.completed {
            border-color: var(--step-complete);
            color: var(--step-complete);
        }
        
        .step h5 {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        h5.section-title {
            color: var(--accent-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 5px;
            margin-bottom: 25px !important;
            font-weight: 600;
        }
        
        /* Champ WhatsApp avec indicatif */
        .whatsapp-input-group {
            display: flex;
            align-items: center;
        }
        .whatsapp-indicatif {
            background-color: var(--chat-bg) !important; 
            color: var(--text-light) !important; 
            border: 1px solid #444 !important;
            padding: 10px 15px;
            border-right: none;
            border-top-left-radius: 6px;
            border-bottom-left-radius: 6px;
            font-weight: bold;
            display: flex;
            align-items: center;
        }
        .whatsapp-indicatif span {
            margin-left: 5px;
        }
        .whatsapp-input-group input {
            border-top-left-radius: 0 !important;
            border-bottom-left-radius: 0 !important;
        }
    </style>
</head>
<body class="bg-dark">

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <h1 class="text-center mb-4" style="color: var(--accent-color);">Inscription Expert ProFinder</h1>
            <p class="text-center text-light lead mb-4">Rejoignez l'annuaire en **4 √©tapes rapides**.</p>

            <div class="form-card p-5">
                <div class="step-indicator">
                    <div class="step active" id="step-1-indicator"><h5>1. Contact</h5></div>
                    <div class="step" id="step-2-indicator"><h5>2. M√©tier</h5></div>
                    <div class="step" id="step-3-indicator"><h5>3. Localisation</h5></div>
                    <div class="step" id="step-4-indicator"><h5>4. Finalisation</h5></div>
                </div>
                
                <form id="pro-inscription-form">

                    <div class="step-content" id="step-1">
                        <h5 class="section-title"><i class="bi bi-person-circle me-2"></i> 1. Informations de Contact</h5>
                        <div class="mb-3">
                            <label for="nom_contact" class="form-label">Nom et Pr√©noms du Contact</label>
                            <input type="text" class="form-control" id="nom_contact" name="nom_contact" required>
                        </div>
                        <div class="mb-3">
                            <label for="nom_entreprise" class="form-label">Noms de l'entreprise ou Marque</label>
                            <input type="text" class="form-control" id="nom_entreprise" name="nom_entreprise" required>
                        </div>
                        <div class="mb-4">
                            <label for="whatsapp" class="form-label">Num√©ro WhatsApp (pour contact client)</label>
                            <div class="whatsapp-input-group">
                                <span class="whatsapp-indicatif">üáßüáØ <span>+229</span></span>
                                <input type="tel" class="form-control" id="whatsapp" name="whatsapp" required pattern="[0-9]{8,15}" title="Saisir uniquement les chiffres du num√©ro.">
                            </div>
                        </div>
                        <button type="button" class="btn custom-btn float-end" onclick="nextStep(2)">Suivant <i class="bi bi-arrow-right-circle-fill ms-2"></i></button>
                    </div>

                    <div class="step-content d-none" id="step-2">
                        <h5 class="section-title"><i class="bi bi-briefcase-fill me-2"></i> 2. Votre Professionnel</h5>
                        <div class="mb-3">
                            <label for="secteur_general" class="form-label">Secteur d'Activit√© G√©n√©ral</label>
                            <select class="form-select" id="secteur_general" name="secteur_general" required>
                                <option value="">S√©lectionner le Secteur Principal (A √† S)</option>
                                </select>
                        </div>
                        <div class="mb-4">
                            <label for="activite_detaillee" class="form-label">Activit√© D√©taill√©e / Sp√©cialit√©</label>
                            <select class="form-select" id="activite_detaillee" name="activite_detaillee" required disabled>
                                <option value="">S√©lectionner d'abord le Secteur Principal</option>
                            </select>
                        </div>
                        <div class="mb-4">
                            <label for="experience_ans" class="form-label">Exp√©rience (Nombre d'ann√©es)</label>
                            <input type="number" class="form-control" id="experience_ans" name="experience_ans" min="0" required>
                        </div>
                        
                        <button type="button" class="btn btn-outline-secondary" onclick="prevStep(1)"><i class="bi bi-arrow-left-circle-fill me-2"></i> Pr√©c√©dent</button>
                        <button type="button" class="btn custom-btn float-end" onclick="nextStep(3)">Suivant <i class="bi bi-arrow-right-circle-fill ms-2"></i></button>
                    </div>

                    <div class="step-content d-none" id="step-3">
                        <h5 class="section-title"><i class="bi bi-geo-alt-fill me-2"></i> 3. Localisation et GPS</h5>
                        <div class="mb-3">
                            <label for="ville" class="form-label">Ville</label>
                            <select class="form-select" id="ville" name="ville" required>
                                <option value="">S√©lectionner votre ville (1 √† 77)</option>
                                </select>
                        </div>
                        <div class="mb-3">
                            <label for="quartier" class="form-label">Votre quartier / Zone</label>
                            <input type="text" class="form-control" id="quartier" name="quartier" required>
                        </div>
                        <div class="mb-4">
                            <label for="indication_gps" class="form-label">Indication GPS / Adresse d√©taill√©e (Point de rep√®re exact)</label>
                            <textarea class="form-control" id="indication_gps" name="indication_gps" rows="2" placeholder="Ex: En face de la pharmacie, rue du march√©, √† c√¥t√© de l'√©cole..." required></textarea>
                        </div>

                        <button type="button" class="btn btn-outline-secondary" onclick="prevStep(2)"><i class="bi bi-arrow-left-circle-fill me-2"></i> Pr√©c√©dent</button>
                        <button type="button" class="btn custom-btn float-end" onclick="nextStep(4)">Suivant <i class="bi bi-arrow-right-circle-fill ms-2"></i></button>
                    </div>

                    <div class="step-content d-none" id="step-4">
                        <h5 class="section-title"><i class="bi bi-patch-check-fill me-2"></i> 4. Finalisation et Engagement</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="prix_min" class="form-label">Prix Min. Estim√© (FCFA)</label>
                                <input type="number" class="form-control" id="prix_min" name="prix_min" placeholder="Ex: 5000" min="0">
                            </div>
                            <div class="col-md-6 mb-4">
                                <label for="prix_max" class="form-label">Prix Max. Estim√© (FCFA)</label>
                                <input type="number" class="form-control" id="prix_max" name="prix_max" placeholder="Ex: 25000" min="0">
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label for="note_avis" class="form-label">Note / Avis Moyen de l'Expert (Entre 3.0 et 5.0)</label>
                            <input type="number" class="form-control" id="note_avis" name="note_avis" step="0.1" min="3.0" max="5.0" placeholder="Ex: 4.5" required>
                            <small class="form-text text-secondary-text">Ceci sera affich√© aux utilisateurs. (3.0 minimum)</small>
                        </div>

                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="public_visibility" name="public_visibility" value="Oui" checked>
                            <label class="form-check-label" for="public_visibility">Souhaitez-vous que vos infos soient visibles publiquement ?</label>
                        </div>
                        <div class="mb-4 form-check">
                            <input type="checkbox" class="form-check-input" id="contact_consent" name="contact_consent" value="Oui" required>
                            <label class="form-check-label" for="contact_consent">J‚Äôautorise les clients √† me contacter (Obligatoire)</label>
                        </div>

                        <button type="button" class="btn btn-outline-secondary" onclick="prevStep(3)"><i class="bi bi-arrow-left-circle-fill me-2"></i> Pr√©c√©dent</button>
                        <button type="submit" class="custom-btn float-end" id="submit-btn">
                            Soumettre mon inscription <i class="bi bi-send-fill ms-2"></i>
                        </button>
                    </div>
                </form>

                <div id="form-message" class="mt-4 p-3 text-center" style="display: none; border-radius: 8px; color: white;"></div>
            </div>
            
            <p class="text-center small text-secondary-text mt-3">L'inscription est sujette √† v√©rification par l'√©quipe ProFinder.</p>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // ‚ö†Ô∏è √âTAPE CRITIQUE : REMPLACER CETTE VALEUR PAR L'URL DE VOTRE APPS SCRIPT D√âPLOY√â
    const FORM_ACTION_URL = 'https://script.google.com/macros/s/AKfycbzsvd1UsVJuNT38zMPgO3WU8_WYjM1sBheqLkrKSr8Jz8tKyO0KTQr7I_ycCRiXZAiw/exec'; 
    let currentStep = 1;

    // --- Donn√©es du formulaire (Inchang√©es) ---
    const ALL_CITIES = [
        'Abomey', 'Abomey Calavi', 'Adja-Ou√®r√®', 'Adjarra', 'Adjohoun', 'Agbangnizoun', 'Agu√©gu√©', 'Allada', 'Aplahou√©', 'Athi√©m√©', 'Avrankou', 'Banikoara', 'Bant√®', 'Bemb√®r√®k√®', 'Bohicon', 'Bonou', 'Bopa', 'Boukomb√©', 'Cobly', 'Com√®', 'Copargo', 'Cotonou', 'Cov√®', 'Dangbo', 'Dassa Zoum√©', 'Djakotomey', 'Djidja', 'Djougou', 'Dogbo', 'Glazou√©', 'Gogounou', 'Grand-Popo', 'Hou√©yogb√©', 'Ifangni', 'Kalal√©', 'Kandi', 'Karimama', 'K√©rou', 'K√©tou', 'Klou√©kanm√®', 'Kouand√©', 'Kpomass√®', 'Lalo', 'Lokossa', 'Malanville', 'Mat√©ri', 'Miss√©r√©t√©', 'N\'dali', 'Natitingou', 'Nikki', 'Ouak√©', 'Ou√®ss√®', 'Ouidah', 'Ouinhi', 'Parakou', 'Pehunco', 'P√©r√®r√®', 'Pob√®', 'Porto Novo', 'Sak√©t√©', 'Savalou', 'Sav√®', 'S√©gbana', 'S√®m√®-Podji', 'Sinand√©', 'So Ava', 'Tangui√©ta', 'Tchaourou', 'Toffo', 'Tori Bossito', 'Toucountouna', 'Toviklin', 'Zagannado', 'Za-Kpota', 'Z√®', 'Zogbodomey'
    ];

    const ALL_ACTIVITIES = {
        'Finance / Assurance': ['Microfinance', 'Agent mobile money', 'Courtier / Assurance', 'Comptabilit√© / Gestion', 'Fintech / Paiement num√©rique'],
        'Transport / Logistique': ['Taxi / Zemidjan', 'Livraison', 'Location de v√©hicules', 'Transit / Fret'],
        'Communication / M√©dias': ['Cr√©ation de contenu', 'Photographe / Vid√©aste', 'Publicit√© / Marketing digital', 'Agence de communication', 'Imprimerie / Graphisme'],
        'Tourisme / Loisirs': ['Guide touristique', 'H√¥tel / Auberge', 'Restaurant / Bar', 'Organisation d‚Äô√©v√©nements', 'Location de salle / espace'],
        'Services √† la personne': ['Garde d‚Äôenfants', 'Femme de m√©nage', 'Assistance √† domicile', 'Agent de s√©curit√©', 'Jardinage'],
        'Agriculture / √âlevage / P√™che': ['Production vivri√®re', '√âlevage', 'Pisciculture', 'Vente de produits agricoles', 'Transformation agroalimentaire'],
        'Droit / Juridique': ['Avocat', 'Conseiller juridique', 'Notaire', 'Cabinet d‚Äôexpertise', 'M√©diation'],
        '√ânergie / Environnement': ['Installation solaire', 'Recyclage', 'Gestion des d√©chets', 'Fourniture d‚Äô√©quipements √©lectriques', '√ânergies renouvelables'],
        'Autres services sp√©cialis√©s': ['Consultant ind√©pendant', 'Traducteur', 'D√©veloppeur freelance', 'Coach / Formateur personnel', 'Service sur mesure'],
        'Alimentation': ['Restauration', 'Traiteur', 'Vente de produits locaux', 'Transformation alimentaire', 'Boulangerie / P√¢tisserie', 'Livraison de repas'],
        'Mode / Couture': ['Styliste / Cr√©ateur', 'Couturier / Couturi√®re', 'Retouche / R√©paration', 'Vente de v√™tements', 'Accessoires de mode'],
        'Beaut√© / Esth√©tique': ['Coiffure', 'Maquillage', 'Manucure / P√©dicure', 'Soins corporels / Massage', 'Spa / Institut'],
        'Technologie / Informatique': ['D√©pannage / R√©paration', 'Vente de mat√©riel', 'D√©veloppement web / mobile', 'Graphisme / Design', 'Formation / Cybers√©curit√©'],
        'Automobile / M√©canique': ['M√©canicien', 'Lavage auto', 'Vente de pi√®ces', 'Peinture auto', 'Diagnostic √©lectronique'],
        'BTP / Construction': ['Ma√ßonnerie', 'Plomberie', '√âlectricit√©', 'Peinture', 'Menuiserie (bois, alu)', 'Architecture / Dessin technique'],
        'Sant√© / Pharmacie': ['Pharmacien', 'Infirmier / Soins √† domicile', 'M√©decin', 'Laboratoire', 'Produits pharmaceutiques / parapharmacie'],
        '√âducation / Formation': ['Enseignant / Cours particuliers', 'Centre de formation', '√âcole priv√©e', 'Formateur professionnel', 'Soutien scolaire'],
        'Artisanat / Cr√©ation': ['Menuiserie', 'Sculpture', 'Tissage / Bijoux', 'D√©coration / Objets artistiques', 'DAO / Mod√©lisation'],
        'Commerce g√©n√©ral': ['Boutique / Vente', 'Supermarch√©', 'Import / Export', 'Vente en ligne (e-commerce)']
    };
    // --- Fin des Donn√©es ---


    // --- Logique du Multi-√âtapes ---

    function updateStepIndicator() {
        for (let i = 1; i <= 4; i++) {
            const indicator = document.getElementById(`step-${i}-indicator`);
            indicator.classList.remove('active', 'completed');
            if (i < currentStep) {
                indicator.classList.add('completed');
            } else if (i === currentStep) {
                indicator.classList.add('active');
            }
        }
    }

    function showStep(stepNumber) {
        document.querySelectorAll('.step-content').forEach(content => {
            content.classList.add('d-none');
        });
        document.getElementById(`step-${stepNumber}`).classList.remove('d-none');
        currentStep = stepNumber;
        updateStepIndicator();
    }

    function validateStep(stepNumber) {
        let isValid = true;
        const currentStepContent = document.getElementById(`step-${stepNumber}`);
        const inputs = currentStepContent.querySelectorAll('[required]');

        inputs.forEach(input => {
            if (!input.checkValidity()) {
                input.reportValidity(); // Affiche le message d'erreur standard
                isValid = false;
            }
        });
        return isValid;
    }

    function nextStep(stepNumber) {
        if (validateStep(stepNumber - 1)) {
            showStep(stepNumber);
        }
    }

    function prevStep(stepNumber) {
        showStep(stepNumber);
    }
    
    // --- Initialisation et √âv√©nements ---

    document.addEventListener('DOMContentLoaded', function() {
        // Initialisation des listes d√©roulantes
        const selectVille = document.getElementById('ville');
        ALL_CITIES.forEach(city => {
            const option = document.createElement('option');
            option.value = city;
            option.textContent = city;
            selectVille.appendChild(option);
        });

        const selectSecteur = document.getElementById('secteur_general');
        Object.keys(ALL_ACTIVITIES).forEach(sector => {
            const option = document.createElement('option');
            option.value = sector;
            option.textContent = sector;
            selectSecteur.appendChild(option);
        });

        // Logique Conditionnelle pour les Activit√©s D√©taill√©es (A √† S)
        const selectActivite = document.getElementById('activite_detaillee');
        selectSecteur.addEventListener('change', function() {
            const selectedSector = this.value;
            selectActivite.innerHTML = '<option value="">S√©lectionner votre Sp√©cialit√©</option>';
            selectActivite.disabled = true;

            if (selectedSector && ALL_ACTIVITIES[selectedSector]) {
                ALL_ACTIVITIES[selectedSector].forEach(activity => {
                    const option = document.createElement('option');
                    option.value = activity;
                    option.textContent = activity;
                    selectActivite.appendChild(option);
                });
                selectActivite.disabled = false;
            }
        });
        
        // Afficher la premi√®re √©tape au chargement
        showStep(1);
    });

    // --- Soumission du Formulaire √† Apps Script ---
    const form = document.getElementById('pro-inscription-form');
    const submitBtn = document.getElementById('submit-btn');
    const messageDiv = document.getElementById('form-message');

    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Derni√®re validation au cas o√π
        if (!validateStep(4)) {
            return;
        }

        const formData = new FormData(form);
        const data = {};
        
        // G√©rer le num√©ro WhatsApp (Ajouter l'indicatif +229 si absent)
        let whatsappNum = formData.get('whatsapp').trim();
        if (!whatsappNum.startsWith('+229')) {
             whatsappNum = '+229' + whatsappNum.replace(/\s/g, ''); // Nettoyer les espaces
        }
        formData.set('whatsapp', whatsappNum);


        formData.forEach((value, key) => {
             data[key] = value;
        });
        
        // G√©rer les cases √† cocher non coch√©es
        if (!formData.get('public_visibility')) data.public_visibility = 'Non';
        if (!formData.get('contact_consent')) data.contact_consent = 'Non';


        submitBtn.disabled = true;
        submitBtn.textContent = 'Envoi en cours...';
        messageDiv.style.display = 'none';

        fetch(FORM_ACTION_URL, {
            method: 'POST',
            mode: 'cors', 
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams(data), 
        })
        .then(response => response.json())
        .then(result => {
            if (result.result === 'success') {
                messageDiv.textContent = '‚úÖ Votre inscription a √©t√© soumise avec succ√®s ! L\'√©quipe ProFinder vous contactera bient√¥t.';
                messageDiv.style.backgroundColor = '#28a745';
                form.reset();
                showStep(1); // Retour √† l'√©tape 1 apr√®s succ√®s
            } else {
                messageDiv.textContent = `‚ùå Une erreur est survenue lors de la soumission. (${result.message || 'Erreur inconnue'})`;
                messageDiv.style.backgroundColor = '#dc3545';
                console.error("Erreur Apps Script:", result.message);
            }
        })
        .catch(error => {
            messageDiv.textContent = '‚ùå Erreur de connexion au serveur. Assurez-vous que l\'URL Apps Script est correcte.';
            messageDiv.style.backgroundColor = '#dc3545';
            console.error('Erreur Fetch:', error);
        })
        .finally(() => {
            submitBtn.disabled = false;
            submitBtn.textContent = 'Soumettre mon inscription';
            messageDiv.style.display = 'block';
        });
    });
</script>
</body>

</html>
